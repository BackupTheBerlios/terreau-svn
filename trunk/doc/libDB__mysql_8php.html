<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>terreau: libDB_mysql.php File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>libDB_mysql.php File Reference</h1>Provides abstraction functions to deal with Mysql servers. <a href="#_details">More...</a>
<p>

<p>
<a href="libDB__mysql_8php-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libDB__mysql_8php.html#a0">DB_connect</a> ($host, $user, $pass)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Opens a connection to a Mysql server, and returns the connection ID.  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libDB__mysql_8php.html#a1">DB_select</a> ($db)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Selects a database on the current connection ID.  <a href="#a1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libDB__mysql_8php.html#a2">DB_query</a> ($query)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Runs a query.  <a href="#a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libDB__mysql_8php.html#a3">DB_dump_result</a> ($result, $print=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dumps a query result in an HTML table.  <a href="#a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libDB__mysql_8php.html#a4">DB_dropdown_list</a> ($result, $text_field, $id_field, $current_value=&quot;&quot;)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function that generates an HTML dropdown list from a query result.  <a href="#a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="libDB__mysql_8php.html#a5">DB_escape_string</a> ($string, $quote=false)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function to clean inputs before querying a database, mandatory to protect the project from "SQL injections".  <a href="#a5"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Provides abstraction functions to deal with Mysql servers. 
<p>
This is not "hardcore" abstraction, but more a bunch of wrapper functions to catch errors and display them cleanly through <a class="el" href="libError_8php.html">libError.php</a>. Other functions in this library are various database-related ones. This library checks for the mysql php extension presence when loaded, and dies if not present.<p>
<dl compact><dt><b>Version:</b></dt><dd>0-24.06.2006 </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Modify this library to make it Object Oriented.</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>When converting to a class, do not forget to close the MySQL connection in the destructor.</dd></dl>

<p>
Definition in file <a class="el" href="libDB__mysql_8php-source.html">libDB_mysql.php</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0"></a><!-- doxytag: member="libDB_mysql.php::DB_connect" ref="a0" args="($host, $user, $pass)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">DB_connect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">$&nbsp;</td>
          <td class="mdname" nowrap> <em>host</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>$&nbsp;</td>
          <td class="mdname" nowrap> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>$&nbsp;</td>
          <td class="mdname" nowrap> <em>pass</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Opens a connection to a Mysql server, and returns the connection ID. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$host</em>&nbsp;</td><td>The host to connect to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$user</em>&nbsp;</td><td>The login used to connect to the server. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$pass</em>&nbsp;</td><td>The password used to connect to the server. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A MySQL connection ID, or false if the connection fails.</dd></dl>

<p>
Definition at line <a class="el" href="libDB__mysql_8php-source.html#l00061">61</a> of file <a class="el" href="libDB__mysql_8php-source.html">libDB_mysql.php</a>.
<p>
References <a class="el" href="libError_8php-source.html#l00140">ER_Handler::getInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4"></a><!-- doxytag: member="libDB_mysql.php::DB_dropdown_list" ref="a4" args="($result, $text_field, $id_field, $current_value=&quot;&quot;)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">DB_dropdown_list           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">$&nbsp;</td>
          <td class="mdname" nowrap> <em>result</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>$&nbsp;</td>
          <td class="mdname" nowrap> <em>text_field</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>$&nbsp;</td>
          <td class="mdname" nowrap> <em>id_field</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>$&nbsp;</td>
          <td class="mdname" nowrap> <em>current_value</em> = <code>&quot;&quot;</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function that generates an HTML dropdown list from a query result. 
<p>
To use this, you need to specify the names of two fields of the query : $text_field (The text to display in the select list) and $id_field (The corresponding uniique ID). One can too provide the current value of that field, if known, so that this value is selected as default in the list (Useful for example when displaying a form to modify an entry...)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$result</em>&nbsp;</td><td>A valid MySQL result. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$text_field</em>&nbsp;</td><td>The query field to use to get the legend for each &lt;select&gt; line. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$id_field</em>&nbsp;</td><td>The query field to use to get the unique id for each &lt;select&gt; line (Usually the primary key of the MySQL table). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$current_value</em>&nbsp;</td><td>The id of the item to mark as selected. Usually the result of the corresponding field in the last form submit. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A string containing the &lt;select&gt; list, which lines match the query, ready to be echo()'ed; </dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>Rename the input vars to remove "_" ? </dd></dl>

<p>
Definition at line <a class="el" href="libDB__mysql_8php-source.html#l00174">174</a> of file <a class="el" href="libDB__mysql_8php-source.html">libDB_mysql.php</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3"></a><!-- doxytag: member="libDB_mysql.php::DB_dump_result" ref="a3" args="($result, $print=0)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">DB_dump_result           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">$&nbsp;</td>
          <td class="mdname" nowrap> <em>result</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>$&nbsp;</td>
          <td class="mdname" nowrap> <em>print</em> = <code>0</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Dumps a query result in an HTML table. 
<p>
This function returns the result of a query as an HTML table. Content and format of the result are guessed automatically. Alternatively, the result can be printed immediately, not returned, based on the value of the $print variable<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$result</em>&nbsp;</td><td>A valid query result ID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$print</em>&nbsp;</td><td>Whether to return the result in a string or echo it directly. 0 means "return a string", 1 means "echo it now"</td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="libDB__mysql_8php-source.html#l00119">119</a> of file <a class="el" href="libDB__mysql_8php-source.html">libDB_mysql.php</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5"></a><!-- doxytag: member="libDB_mysql.php::DB_escape_string" ref="a5" args="($string, $quote=false)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">DB_escape_string           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">$&nbsp;</td>
          <td class="mdname" nowrap> <em>string</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>$&nbsp;</td>
          <td class="mdname" nowrap> <em>quote</em> = <code>false</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function to clean inputs before querying a database, mandatory to protect the project from "SQL injections". 
<p>
To unescape the string, "stripslashes()" is enough. Optionnally, one can request this function not to single-quote the result, by setting $quote to 'false'. This function was stolen from <a href="http://php.net">http://php.net</a> examples ;-)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$string</em>&nbsp;</td><td>The string to escape before using in a MySQL query. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$quote</em>&nbsp;</td><td>Set to 'true' to force enclosure of the output with single-quotes, false otherwise. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The escaped string, ready for a MySQL query.</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>Rewrite the error handling, and use another criticity.</dd></dl>

<p>
Definition at line <a class="el" href="libDB__mysql_8php-source.html#l00202">202</a> of file <a class="el" href="libDB__mysql_8php-source.html">libDB_mysql.php</a>.
<p>
References <a class="el" href="libError_8php-source.html#l00140">ER_Handler::getInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2"></a><!-- doxytag: member="libDB_mysql.php::DB_query" ref="a2" args="($query)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">DB_query           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">$&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>query</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Runs a query. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$query</em>&nbsp;</td><td>A string containing the MySQL query. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The result ID or false if the query fails</dd></dl>

<p>
Definition at line <a class="el" href="libDB__mysql_8php-source.html#l00095">95</a> of file <a class="el" href="libDB__mysql_8php-source.html">libDB_mysql.php</a>.
<p>
References <a class="el" href="libError_8php-source.html#l00140">ER_Handler::getInstance()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1"></a><!-- doxytag: member="libDB_mysql.php::DB_select" ref="a1" args="($db)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">DB_select           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">$&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>db</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Selects a database on the current connection ID. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$db</em>&nbsp;</td><td>Name of the database to select. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>True if success or false on failure.</dd></dl>

<p>
Definition at line <a class="el" href="libDB__mysql_8php-source.html#l00078">78</a> of file <a class="el" href="libDB__mysql_8php-source.html">libDB_mysql.php</a>.
<p>
References <a class="el" href="libError_8php-source.html#l00140">ER_Handler::getInstance()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Fri Sep 29 13:36:33 2006 for terreau by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.4 </small></address>
</body>
</html>
